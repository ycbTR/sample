/*
* Copyright (C) 2009 Joel Sutherland
* Licenced under the MIT license
* http://www.newmediacampaigns.com/page/jquery-flickr-plugin
*
* Available tags for templates:
* title, link, date_taken, description, published, author, author_id, tags, image*

* ********************************************************
* Further modifications by Rahisi Themes 2014.
  --------------------------------------------------------
  - Added data attributes support
  - Added grid output
  ********************************************************
*/
function getColWidth(t,e,n,i){var s=(n-e*(t-1))/t;return"px"==i?Math.floor(s):+(Math.round(s+"e+2")+"e-2")}!function(t){t.fn.jflickrfeed=function(e,n){e=t.extend(!0,{flickrbase:"http://api.flickr.com/services/feeds/",feedapi:"photos_public.gne",limit:20,qstrings:{lang:"en-us",format:"json",jsoncallback:"?"},cleanDescription:!0,useTemplate:!0,itemTemplate:"",itemCallback:function(){}},e);var i,s=t(this).attr("data-userid"),o=t(this).attr("data-limit"),a=t(this).attr("data-cols"),r=t(this).attr("data-margin");if(isNaN(o)||(e.limit=parseInt(o)),s&&(e.qstrings.id=s),!isNaN(a)){cols=parseInt(a);var l,c,u="";i=new Object,-1!=r.indexOf("%")?(l=100,c=r.length-1,u="%",i.margin=parseInt(r.substring(0,c)),i.marginString=i.margin+u,i.width=getColWidth(cols,i.margin,l,u),i.widthString=i.width+u):-1!=r.indexOf("px")?(l=t(this).parent().width(),c=r.length-2,u="px",i.margin=parseInt(r.substring(0,c)),i.marginString=i.margin+u,i.width=getColWidth(cols,i.margin,l,u),i.widthString=i.width+u):(l=100,u="%",i.margin=parseInt(r),i.marginString=i.margin+u,i.width=getColWidth(cols,i.margin,l,u),i.widthString=i.width+u);var d=".flickr-grid { display:block; list-style:none; padding:0; margin: 0;}";d+=".flickr-grid > li { display:block; float: left} ",d+=".flickr-grid > li img { width:100%; height:auto; line-height:1; display:block} ",t("<style>").prop("type","text/css").html(d).appendTo("head"),t(this).addClass("flickr-grid"),i.style="width:"+i.widthString+"; margin:0 "+i.marginString+" "+i.marginString+" 0; }",i.lastStyle="width:"+i.widthString+"; margin:0 0 "+i.marginString+" 0; }"}var h=e.flickrbase+e.feedapi+"?",p=!0;for(var f in e.qstrings)p||(h+="&"),h+=f+"="+e.qstrings[f],p=!1;return t(this).each(function(){var s=t(this),o=this;t.getJSON(h,function(a){t.each(a.items,function(t,n){if(t<e.limit){if(e.cleanDescription){var a=/<p>(.*?)<\/p>/g,r=n.description;a.test(r)&&(n.description=r.match(a)[2],void 0!=n.description&&(n.description=n.description.replace("<p>","").replace("</p>","")))}if(n.image_s=n.media.m.replace("_m","_s"),n.image_t=n.media.m.replace("_m","_t"),n.image_m=n.media.m.replace("_m","_m"),n.image=n.media.m.replace("_m",""),n.image_b=n.media.m.replace("_m","_b"),delete n.media,e.useTemplate){var l=e.itemTemplate;for(var c in n){var u=new RegExp("{{"+c+"}}","g");l=l.replace(u,n[c])}i&&(l=(t+1)%cols==0?l.replace("item_style",i.lastStyle):l.replace("item_style",i.style)),s.append(l)}e.itemCallback.call(o,n)}}),t.isFunction(n)&&n.call(o,a)})})}}(jQuery);